=== Paid Memberships Pro ===
Contributors: strangerstudios, kimannwall, andrewza, dlparker1005, paidmembershipspro
Tags: memberships, members, subscriptions, ecommerce, user registration, member, membership, e-commerce, paypal, stripe, braintree, authorize.net, payflow, restrict access, restrict content, directory
Requires at least: 5.2
Tested up to: 5.8.1
Requires PHP: 5.6
Stable tag: 2.6.6

Get Paid with Paid Memberships Pro: The most complete member management and membership subscriptions plugin for your WordPress site.

== Description ==

= The most complete member management and membership subscriptions plugin for WordPress =

Paid Memberships Pro gives you all the tools you need to start, manage, and grow your membership site. The plugin is designed for premium content sites, online course or LMS and training-based memberships, clubs and associations, members-only product discount sites, subscription box products, paid newsletters, and more.

Users can select a membership level, complete checkout, and immediately become members of your site. You decide what content your member can access. Members can log in, view payments, update billing info, or cancel their account directly on your site.

= Simple to set up, deeply customizable =

* Restrict access to [members-only content](https://www.paidmembershipspro.com/documentation/content-controls/).
* Create unlimited [membership levels with flexible pricing](https://www.paidmembershipspro.com/documentation/membership-levels/) including free memberships, trials, recurring payments and subscriptions, one-time payments, and more.
* Integrate with [Stripe](https://www.paidmembershipspro.com/gateway/stripe/), [PayPal](https://www.paidmembershipspro.com/gateway/paypal/), and other [popular gateways](https://www.paidmembershipspro.com/gateway/).
* Manage your full membership data, import and export members or orders, and [view reports](https://www.paidmembershipspro.com/documentation/reports/) on sales and revenue, cancellations, expirations, and signups.
* Robust [REST API endpoints](https://www.paidmembershipspro.com/documentation/advanced/api/rest-api/) including [native integration with Zapier](https://www.paidmembershipspro.com/documentation/compatibility/zapier/) to connect your apps and automate workflows with no code.
* [100% GPL, fully open source](https://www.paidmembershipspro.com/features/paid-memberships-pro-is-100-gpl/), and integrated with loads of third-party platforms.

[youtube https://www.youtube.com/watch?v=-M3aoEHvGZ4]

= Member Experience Features =

* Frontend Log In
* Frontend User Registration
* Frontend Password Recovery
* Frontend Profile Editing
* Membership Account Dashboard
* Membership Invoices and Billing Information Pages
* [Custom User Profile and Registration Form Fields](https://www.paidmembershipspro.com/add-ons/pmpro-register-helper-add-checkout-and-profile-fields/)
* [Custom Member Emails](https://www.paidmembershipspro.com/documentation/member-communications/customizing-email-templates/)
* Restrict WP Dashboard Access
* Hide the WP Toolbar

[View all Screenshots](https://www.paidmembershipspro.com/features/screenshots/)

= Content Protection Features =

* Restrict Default Content: [posts and categories](https://www.paidmembershipspro.com/documentation/content-controls/for-posts/), [pages](https://www.paidmembershipspro.com/documentation/content-controls/for-pages/), and [blocks](https://www.paidmembershipspro.com/documentation/content-controls/with-the-membership-block/).
* Restrict Custom Post Types: [events](https://www.paidmembershipspro.com/add-ons/events-for-members-only/), [courses](https://www.paidmembershipspro.com/online-learning-and-courseware-for-membership-sites/), [downloads](https://www.paidmembershipspro.com/add-ons/pmpro-download-monitor/), and [any custom post type, including WooCommerce products](https://www.paidmembershipspro.com/add-ons/custom-post-type-membership-access/).
* Protect Courses: [Create courses with lessons](https://www.paidmembershipspro.com/add-ons/pmpro-courses-lms-integration/) and manage member access access. Integrates membership with third party LMS plugins including [LearnDash](https://www.paidmembershipspro.com/add-ons/pmpro-courses-lms-integration/#learndash-module) and [LifterLMS](https://www.paidmembershipspro.com/add-ons/pmpro-courses-lms-integration/#lifterlms-module).
* Create an Interactive Members-only Community: lock down [BuddyPress](https://www.paidmembershipspro.com/add-ons/buddypress-integration/) and [bbPress](https://www.paidmembershipspro.com/add-ons/pmpro-bbpress/).
* [Drip-Feed / Series Type Content](https://www.paidmembershipspro.com/add-ons/pmpro-series-for-drip-feed-content/)
* Offer [personalized content to each member](https://www.paidmembershipspro.com/add-ons/pmpro-user-pages/), [customize navigation menus](https://www.paidmembershipspro.com/add-ons/pmpro-nav-menus/), and design [unique member dashboards](https://www.paidmembershipspro.com/add-ons/member-homepages/).
* Restrict Elementor elements or Beaver Builder modules.
* Offer [Member Directories and Profiles](https://www.paidmembershipspro.com/add-ons/member-directory/) for your members.

= Integrated Payment Gateways =

All of our payment gateways are included in the plugin. Choose from [Stripe](https://www.paidmembershipspro.com/gateway/stripe/), [PayPal](https://www.paidmembershipspro.com/gateway/paypal/), [Authorize.net](https://www.paidmembershipspro.com/gateway/authorize-net/), [Braintree](https://www.paidmembershipspro.com/gateway/braintree/), or [2Checkout](https://www.paidmembershipspro.com/gateway/2checkout/). You can offer multiple gateway options at checkout including [PayPal Express](https://www.paidmembershipspro.com/add-ons/pmpro-add-paypal-express-option-checkout/) or [offline payment by check or direct transfer](https://www.paidmembershipspro.com/add-ons/pmpro-pay-by-check-add-on/).

= Flexible Level Pricing and Expirations  =

* One-time Payments
* Recurring Subscriptions
* Custom Trials
* Custom Renewal Dates
* Variable Pricing and Donations
* Discount Codes
* Prorated Payments
* Yearly, Monthly, Daily, and Hourly Expiration.

= Popular Add Ons =

Extend the features of your membership site or integrate with third-party services through our library of over 65 Add Ons. Some of the most popular features include:

* [WooCommerce Integration](https://www.paidmembershipspro.com/add-ons/pmpro-woocommerce/) to sell membership as a product or offer members-only discounts in your shop.
* Integrate members with [email marketing](https://www.paidmembershipspro.com/email-marketing-integrations-paid-memberships-pro/) platforms including [Mailchimp](https://www.paidmembershipspro.com/add-ons/pmpro-mailchimp-integration/).
* [Manage Affiliates](https://www.paidmembershipspro.com/managing-affiliates-with-paid-memberships-pro/) with Add Ons or use a popular third-party systems like [AffiliateWP](https://www.paidmembershipspro.com/using-affiliatewp-with-paid-memberships-pro/).
* Let members [log in or join with their social media profiles](https://www.paidmembershipspro.com/add-ons/social-login-add-on/).
* Design your site [using popular Page Builders](https://www.paidmembershipspro.com/using-page-builders-to-enhance-your-sites-membership-pages/) like Elementor, Page Builder by SiteOrigin, Beaver Builder, and Divi. We offer 15 core membership blocks for the WordPress Block Editor (Gutenberg).
* Create a [sales landing page with banners to run a sitewide or flash sale](https://sitewidesales.com).
* [Offer members-only events](https://www.paidmembershipspro.com/add-ons/events-for-members-only/) with Events Manager, The Events Calendar, Sugar Calendar, or All-in-One Event Calendar.

[View all Add Ons](https://www.paidmembershipspro.com/add-ons/)

= Paid Memberships Pro is a free membership plugin for WordPress =

Our plugin is 100% GPL and available from the WordPress repository or on our site at [www.paidmembershipspro.com](https://www.paidmembershipspro.com). The full version of the plugin is offered with no restrictions or additional licenses required. Developers should get involved at [our GitHub page](https://github.com/strangerstudios/paid-memberships-pro/).

== Installation ==

= Download, Install and Activate! =
1. Go to Plugins > Add New to find and install Paid Memberships Pro.
2. Or, download the latest version of the plugin, then go to Plugins > Add New and click the "Upload Plugin" button to upload your .zip file.
3. Activate the plugin.

= Complete the Initial Plugin Setup =
Go to Memberships > Dashboard in the WordPress admin to begin setup. Our [Initial Setup Tutorial](https://www.paidmembershipspro.com/documentation/initial-plugin-setup/) will show you how to configure the following required pages:

1. Membership Levels: Add one or more levels
2. Page Settings: Generate frontend pages
3. Payment Gateway: Select and configure your gateway and SSL
4. Email: Customize email settings and email templates
5. Advanced Settings: Update non-member messages, content filters, dashboard access, and more.

= More Installation and Setup Documentation =
* [Installation Video](https://www.paidmembershipspro.com/documentation/initial-plugin-setup/tutorial-video/)
* [Installation Docs](https://www.paidmembershipspro.com/documentation/initial-plugin-setup/)
* [Membership Levels](https://www.paidmembershipspro.com/documentation/membership-levels/)
* [Payment Gateways](https://www.paidmembershipspro.com/gateway/)
* [Add Ons](https://www.paidmembershipspro.com/add-ons/)

== Frequently Asked Questions ==

= I need help installing, configuring, or customizing the plugin. =
Please visit [our support site at https://www.paidmembershipspro.com](https://www.paidmembershipspro.com) for more documentation and our support forums.

= I found a bug in the plugin. =
Please post it in the [WordPress support forum](https://wordpress.org/support/plugin/paid-memberships-pro/) and we'll fix it right away. Thanks for helping.

= My site is broken or blank or not letting me log in after activating Paid Memberships Pro =
This is typically caused by a conflict with another plugin that is trying to redirect around the login/register pages or trying to redirect from HTTP to HTTPS, etc.

To regain access to your site, FTP to your site and rename the `wp-content/plugins/paid-memberships-pro` folder to wp-content/plugins/paid-memberships-pro-d (or anything different). Now WP will not be able to find PMPro, and you can gain access to /wp-admin/ again. From there, visit the plugins page to fully deactivate Paid Memberships Pro. (You'll want to rename the folder back to paid-memberships-pro again.)

Long term, you will need to find and fix the conflict. We can usually do this for you very quickly if you sign up for support at https://www.paidmembershipspro.com/pricing/ and send us your WP admin and FTP credentials.

= Does PMPro Support Multisite/Network Installs? =
"Supporting multisite" means different things to different people. [This guide covers the three primary ways](https://www.paidmembershipspro.com/network-multisite-mega-post-paid-memberships-pro/) you can use Paid Memberships Pro in a network.

Out of the box PMPro will basically act as a stand alone plugin for each site. Each site has its own list of membership levels, members, payment settings, etc.

Our [Member Network Sites Add On](https://www.paidmembershipspro.com/add-ons/pmpro-network-multisite-membership/) allows members to choose a site name and title at checkout and will set up a network site at checkout.

Our [Multisite Membership Add On](https://www.paidmembershipspro.com/add-ons/pmpro-network-membership/) allows you to manage memberships at the 'Main' Network site and provide or restrict access on other Network Subsites.

If you would like more help using PMPro on a network install, sign up for support at https://www.paidmembershipspro.com.

= Does PMPro Support X? =
Not sure? You can find out by doing a bit a research.

1. [Check our compatibility page](https://www.paidmembershipspro.com/documentation/compatibility/).
2. [Check our Add Ons](https://www.paidmembershipspro.com/add-ons/).
3. [Do a search on our site](https://www.paidmembershipspro.com/).
4. [Ask in the forums here](https://wordpress.org/support/plugin/paid-memberships-pro/).

== Screenshots ==

1. Optimized Membership Checkout page that blends seamlessly into your WordPress site. Fields captured at checkout can be modified with other Add Ons.
2. Set up the membership levels that best fit your business, whether they are Free, Paid, or Subscriptions (Annual, Monthly, Weekly, Daily). Offer Custom Trial Periods (Free Trial, Custom-length Trial, 'Introductory' Pricing)
3. Easy to use Membership Access Settings by Page, Post, or Category. Shortcodes to display restricted content inline. Developer-friendly hooks to restrict access any way you need.
4. Members are WordPress Users. PMPro provides a unique interface to view a single member's history, filter and search all Members or export your Members List.
5. Offer Membership Discounts with specific price rules (restricted by level, unique pricing for each level, # of uses, expiration date.)
6. Filterable Sales Revenue Reports (reports also included for Visits, Views, Logins, Signups, Cancellations, and other Membership Stats).
7. Advanced settings for updating non-member messages, optionally show excerpts or filter content, use reCAPTCHA, and a Terms of Service checkbox.
8. Membership levels selection page, filter the shortcode with additional attributes using add ons or the Memberlite theme.
9. Membership Account page, display all sections or show specific sections using shortcode attributes.

== Changelog ==
= 2.6.6 - 2021-11-18 =
* SECURITY: Updated escaping on the discount codes page in the dashboard to prevent XSS attacks. #1867 (Thanks, Erwan from WPScan)
* BUG FIX/ENHANCEMENT: Added code to remove duplicate active rows in the pmpro_memberships_users table after level change. This might have happened e.g. if users were purchasing a level via the WooCommerce Add On multiple times. #1860 (@dlparker1005)
* BUG FIX/ENHANCEMENT: Improved the REST API endpoints to better support Zapier native requirements. #1862 (@andrewlimaza)
* BUG FIX: Fixed PHP notices in the name parser library. #1861 (@sc0ttkclark)

= 2.6.5 - 2021-11-12 =
* ENHANCEMENT: Introduced new action `pmpro_before_commit_express_checkout` to allow additional changes after an order has been saved but before sending customer to PayPal Express checkout. #1852 (@mircobabini)
* BUG FIX/ENHANCEMENT: Added login compatibility for Jetpack WordPress.com SSO when using the PMPro login page. #1848 (@sc0ttkclark)
* BUG FIX: Fixed PHP notices from status headers when server protocol information is unavailable. #1849 (@dparker1005)
* BUG FIX: Fixed metadata compatibility for membership levels and orders when calling `get_pmpro_membership_level_meta()` and `get_pmpro_membership_order_meta()` so they support getting all meta values for all keys. #1853 (@mircobabini)
* BUG FIX: Escape all Webhook communication debug output coming from gateways. #1855 (@ideadude, Victor Garcia)

= 2.6.4 - 2021-11-02 =
* ENHANCEMENT: Now including some information from the htaccess file in Site Health, including whether a getfile.php script is defined or if caching is being used. (@sc0ttkclark)
* ENHANCEMENT: Now including some of the PMPro-related PHP constants in the Site Health. (@sc0ttkclark)
* ENHNACEMENT: Now including the minimum PHP version (5.6 currently) in the readme.txt so it's shared on the WordPress.org page. (@sc0ttkclark)
* ENHANCEMENT: Added scrollable classes to the member history shown on user profile edit page in the dashboard. (@kimcoleman)
* BUG FIX/ENHANCEMENT: Now sending a 200 OK status message early when the Stripe webhook is running to avoid timeout issues. We may use this new pmpro_send_200_http_response in the other webhook/IPN handlers later on. (@dparker1005)
* BUG FIX/EHNANCEMENT: Removed the "fee" info from the edit user page. This was often misleading. The fee is still shown on the members list and frontend account page. Future updates will include work to make sure the fee is more accurate in cases where subscriptions or levels are being changed by admins after checkout. (@ideadude)
* BUG FIX/ENHANCEMENT: Once again enqueuing the admin.css file on all WP admin pages. This fixes issues where styles weren't being applied to the edit user/profile page in the dashboard. (@ideadude)
* BUG FIX/ENHANCEMENT: Removed the "Member Value Report". We didn't intend to move this over from the old Member History add on. The report was inaccurate and had optimization issues. (@kimcoleman)
* BUG FIX/ENHANCEMENT: Added login compatibility for wordpress.com hosted sites. This fixes some issues with wordpress.com's SSO when using the PMPro login page. (@sc0ttkclark)
* BUG FIX: Fixed issue introduced in 2.6.3 where memberships were not being cancelled when cancelled at PayPal. (@mircobabini)
* BUG FIX: Now including time when calculating profile start date. In the past, we would set it to 00:00:00 which could add or remove a few hours from the subscription. (@dparker1005)
* BUG FIX: Fixed issue where enddates were incorrectly set sometimes when expiration period was "Hour". (@kimwhite)

= 2.6.3 - 2021-10-11 =
* ENHANCEMENT: Now passing "app" information to Stripe through API calls. (@dparker1005)
* ENHANCEMENT: Updated PayPal IPN to detect messages for refunds to at least log it. (@mircobabini)
* ENHANCEMENT: Updated PayPal IPN to differentiate between cases where the initial payment failed vs a subscription was cancelled. (@mircobabini)
* ENHANCEMENT: Better styling of the membership levels history when empty. (@mircobabini)
* BUG FIX/ENHANCEMENT: Now showing better error messages when license key checks fail due to connection issues. (@ideadude)
* BUG FIX: Improved PayPal API integration to handle cases where PayPal is returning encoding errors but still processing payments and subscriptions. (@mircobabini)
* BUG FIX: Fixed issue where the Stripe sandbox key wasn't saved properly when using Stripe connect. (@dparker1005)
* BUG FIX: Fixed issue where a double $$ was showing up in specific emails. (@andrewlimaza)
* BUG FIX: Fixed warnings in various webhook and IPN handlers. (@ideadude)
* BUG FIX: Fixed warning in the admin activity email cron job. (@andrewlimaza)

= 2.6.2 - 2021-09-17 =
* ENHANCEMENT: Made username the first column in the members list. This helps with the mobile view. #1764 (@dparker1005)
* BUG FIX/ENHANCEMENT: Will now block uninstall.php from running if an older version of PMPro is deleted from the plugins page. #1773 (@mircobabini)
* BUG FIX/ENAHCEMENT: Expanded the allowed HTML for pmpro_kses to support email templates and added a pmpro_kses filter. #1770 (@sc0ttkclark)
* BUG FIX/ENHANCEMENT: Updated the CSS for "clickable" labels in checkbox lists. #1752 (@kimcoleman)
* BUG FIX: Fixed bug with sending test emails from the email templates page. #1765 (@ideadude)
* BUG FIX: Added the !!membership_level_confirmation_message!! var to the list on the email tempaltes page. #1783 (@kimwhite)
* BUG FIX: Updated the SendWP link per their new dashboard area. #1777 (@kimcoleman)
* BUG FIX: Fixed bug where PMPro-related usermeta was sometimes blanked out if those fields weren't present at checkout, e.g. when a logged in user was checking out. #1762 (@andrewlimaza)
* BUG FIX: Fixed issue where gateway-related notices weren't showing up on the discount codes page. #1757 (@mircobabini)
* BUG FIX: Fixed some design issues with the member history tables. #1753 (@mircobabini)
* BUG FIX: Fixed issues where the option to block subscribers from the dashboard would interfere with other plugins, e.g. the MailPoet plugin. #1749 (@sc0ttkclark)
* BUG FIX: Fixed issues where the RTL stylesheets might not load if your theme overrode frontend.css or admin.css but didn't have the RTL equivalents. (@ideadude, @sc0ttkclark)

= 2.6.1.1 - 2021-08-25 =
* BUG FIX: Fixed issue with PMPro blocks not showing up in the block editor.
* REFACTOR: Some JS functions and element IDs and names have been prefixed with pmpro_ to avoid conflicts.

= 2.6.1 - 2021-08-24 =
* SECURITY: Added capability checks to further tighten security around email template settings. (@ideadude, @sc0ttkclark)
* SECURITY: Added a pmpro_kses function and using that to sanitize email template bodies and all email bodies before sending. (@ideadude, @sc0ttkclark)
* ENHANCEMENT: Added Email Templates link to PMPro Dashboard for getting started. #1722 (@kimcoleman)
* ENHANCEMENT: All actions in the admin list tables are now filterable for Discount Codes (`pmpro_discountcodes_row_actions`), Membership Levels (`pmpro_membershiplevels_row_actions`), and Orders (`pmpro_orders_user_row_actions`). #1686 (@sc0ttkclark, @mircobabini)
* BUG FIX: Ensure our admin scripts/styles only load on PMPro admin pages. #1724 (@sc0ttkclark)
* BUG FIX: Remove unused code in `pmpro_comments_filter()` that was triggering a PHP warning. #1730 (@freax)
* BUG FIX: Stop turning on autoloading for PMPro options when saving them. #1719 (@freax)
* BUG FIX: Prevent fatal error for PHP 8 in `pmpro_email_templates_email_data()` to strictly check for `WP_User` objects. #1729 (@ZebulanStanphill)
* BUG FIX: Fix problem where `pmpro_round_price()` would not take into account currencies with decimals set to 0. #1732 (@dparker1005, @ipokkel, @sc0ttkclark)
* BUG FIX: Clarify that Stripe Legacy keys remain connected and will continue to work. #1735 (@dparker1005, @sc0ttkclark)

= 2.6 - 2021-08-12 =
* FEATURE: Updated Stripe integration to use Stripe Connect. See [Gateway Fees](https://www.paidmembershipspro.com/gateway/stripe/#tab-fees) for information about transaction fees for Stripe Connect and our platform fee for those without an active Plus/Unlimited license.
* FEATURE: Improved REST API endpoints to support Zapier integration natively.
* FEATURE: You can now set levels to expire after a certain number of hours, and can set users to expire at a specific time down to the minute.
* FEATURE: The Member History Add On has been merged into the core PMPro plugin. A table of the user's membership and order history is shown on the edit user page of the admin dashboard.
* FEATURE: The Email Templates Add On has been merged into the core PMPro plugin. You can edit PMPro-related email templates from the Memberships -> Settings -> Email Templates page in the admin dashboard.
* FEATURE: You can now use PMPro blocks in the new widget area of WP 5.8.
* BUG FIX/ENHANCEMENT: Establishing style for scrollable boxes throughout core plugin.
* BUG FIX/ENHANCEMENT: Using HTTPS to set the pmpro_visit cookie if over HTTPS. (Thanks, freax on GitHub)
* BUG FIX: Fixed fatal error in PHP 8 when deleting a Stripe webhook. (Thanks, Zebulan Stanphill)
* BUG FIX: Fixed warnings shown on the widget page when using WP 5.8+.

= 2.5.10.2 - 2021-08-02 =
* ENHANCEMENT: New scripts to use WP CLI to update pot and po/mo files.
* BUG FIX/ENHANCEMENT: Updated cancellation logic to support upcoming Cancel on Next Payment Date Add On changes.
* BUG FIX/ENHANCEMENT: Making sure to use the correct security setting when calling setcookie from an HTTPS site. (Thanks, freax on GitHub)
* BUG FIX: Now archiving Stripe products after checkout. We create a unique product for each checkout, and these would clutter up the Stripe reports.
* BUG FIX: Fixing data erasure and data export request action for login page.
* BUG FIX: Fixed issue where PMPro settings on Elementor elements could override the "should_render" setting incorrectly. (Thanks, codezz on GitHub)
* BUG FIX: Now catching the case where you try to email an invoice for an order that has no user.

= 2.5.10.1 - 2021-07-05 =
* BUG FIX/ENHANCEMENT: The 'Edit Code: %s' string on the discount codes page is now wrapped for translation.
* BUG FIX: Fixed issue with the getfile.php script introduced in 2.5.10.

= 2.5.10 - 2021-06-25 =
* SECURITY: Fixed XSS vulnerability on the edit order page in the dashboard. (Thanks, Scott Kingsley Clark)
* ENHANCEMENT: Improved escaping and localization for the message returned when clicking to apply discount code.
* ENHANCEMENT: Now hiding gateway setting API keys behind asterisks.
* ENHANCEMENT: Added some extra hooks to the edit membership levels page in the dashboard: pmpro_membership_level_after_billing_details_settings, pmpro_membership_level_after_other_settings, pmpro_membership_level_after_content_settings.
* ENHANCEMENT: Added a pmpro_after_order_settings_table hook to the edit order page in the dashboard.
* BUG FIX/ENHANCEMENT: Now passing a CARDONFILE parameter with PayPal Payflow payment and subscription transactions.
* BUG FIX/ENHANCEMENT: Using the wp.passwordStrength.userInputDisallowedList function from WP 4.5 if available.
* BUG FIX/EHNANCEMENT: Now making sure that the pmpro_update_order and pmpro_updated_order hooks fire whenever an order is updated in the DB.
* BUG FIX: Fixed issue in getfile script where parameters in the URL would cause File not found errors.
* BUG FIX: Fixed how the PayPal IPN handler handles cases where a subscription is set up correctly but the initial payment failed. We now correctly cancel these users and mark their order as error.
* BUG FIX: Improved error handling in the PayPal Express integration, particularly when a subscriptions PROFILESTATUS is missing.
* BUG FIX: User registered date is now shown in local time.
* BUG FIX: Fixed issue where the deprecated pmpro_getClassForField function wasn't returning a value properly. (Thanks, Elena Draculet)
* BUG FIX: Updated the pmpro_sort_levels_by_order function to use level IDs for keys, since some code expects that for level arrays. This matches the behavior we had before introducing this function.
* BUG FIX: Updated the pmpro_changeMembershipLevel function always set the order status to error if that was passed in as the "old level status".
* BUG FIX: Fixed warning in searches/pages when PMPro pages is not set.
* BUG FIX: Fixed warnings being generated when using PHP 8 and Divi
* BUG FIX: Fixed warnings related to PayPal Express session variables.

= 2.5.9.1 - 2021-05-12 =
* BUG FIX/ENHANCEMENT: Updated pmpro_changeMembershipLevel() to return null if the user's level is not changed. For the past 2 vesions, we've been returning true in these cases, which caused PMPro to send emails to the admin when the edit use page was saved, even if there was no level change. This change has been backported to versions 2.5.8 and 2.5.9.

= 2.5.9 - 2021-05-05 =
* ENHANCEMENT: Adjusting style for prices and price parts shown on the frontend.
* ENHANCEMENT: Adjusting HTML for links in the Orders table in the dashboard.
* BUG FIX: Reverted the change to the pmpro_is_checkout() function. Since we default to the first available level, calling pmpro_getLevelForCheckout() was causing pmpro_is_checkout to return true on ALL pages. This disrupted a lot of functionality.
* BUG FIX: Fixed warnings in the pmpro_getLevelAtCheckout() function.
* BUG FIX: Fixed issue where "All Time Sales" was showing up as 0, even when there were sales.

= 2.5.8 - 2021-04-30 =
* ENHANCEMENT: Added `pmpro_membership_content_filter` filter to let other plugins change how PMPro filters member content.
* ENHANCEMENT: Improved de_DE email template translation. (Thanks, biker238 on GitHub)
* ENHANCEMENT: Added `pmpro_change_level` filter.
* ENHANCEMENT: Improved display of prices on invoices and added pmpro_display_price_parts function and filters so plugins like the upcoming AvaTax add on can add subtotals to the price displays.
* ENHANCEMENT: Added a pmpro_after_all_membesrhip_level_changes hook that fires at the end of the page load and can be used to process all membership changes in bulk.
* ENHANCEMENT: The "User" column on the orders page now shows the username and email.
* ENHANCEMENT: Added a pmpro_stripe_create_subscription_array filter. (Thanks, ermGit on GitHub)
* BUG FIX/ENHANCEMENT: pmpro_change_level returns true now if the function is called to change a user’s level to one they already have.
* BUG FIX/ENHANCEMENT: No longer calling $order->updateTimestamp() on orders adminpage.
* BUG FIX/ENHANCEMENT: Updated conditional to check ‘street’ instead of ‘name’ when displaying billing address on Invoice/Confirmation.
* BUG FIX/ENHANCEMENT: Improved localization and added missing strings to translation.
* BUG FIX/ENHANCEMENT: Updated to use `get_user_locale1 to load localization.
* BUG FIX/ENHANCEMENT: Now Preserving existing values for `post__not_in` and `category__not_in` when filtering search and archive queries.
* BUG FIX/ENHANCEMENT: Fixed sorting of the Membership Level column on the Users List table in the WP admin dashboard.
* BUG FIX/ENHANCEMENT: Added a pmpro_sort_levels_by_order function and using it in various places to make sure levels are listed in the order they are in on the PMPro settings page.
* BUG FIX/ENHANCEMENT: Added an extra check in the pmpro_is_checkout function that helps with issues that were coming up in some add ons.
* BUG FIX/ENHANCEMENT: The level cache now takes into account the $include_active parameter.
* BUG FIX/ENHANCEMENT: The CSS class is now properly added to the body tag when a PMPro page block is used on a page.
* BUG FIX/EHNANCEMENT: Better timezone handling in sales reports.
* BUG FIX/ENHANCEMENT: Fixed a few places where we might think a free order was paid if using a currency with more or less than 2 decimal places.
* BUG FIX: Fixed deprecated jQuery functions in pmpro-admin.js.
* BUG FIX: Fixed warning for a missing/deleted level in the pmpro_post_classes function.
* BUG FIX: Default `pmpro_longform_address` to true on Billing Information page.
* BUG FIX: Fixed `pmpro_twocheckout_validate` filter.
* BUG FIX: Fixed variables passed to the `pmpro_discount_code_used` filter.
* BUG FIX: CZK currency should have 2 decimals.
* BUG FIX: Avoiding a redirect loop if the login page is deleted. (Thanks, George Stephanis)
* BUG FIX: Fixed the password reset link in new user notification email when not using pretty permalinks.
* BUG FIX: Fixed issues with password reset URLs on multisite networks.
* BUG FIX: Fixed the issue where sales weren't showing up on report charts sometimes on the 31st of the month.

= 2.5.7 - 2021-03-10 =
* ENHANCEMENT: Added a pmpro_checkout_message filter that can be used to filter error messages shown at checkout.
* BUG FIX/ENHANCEMENT: Now making sure some billing address fields are available for the billing failure emails sent during the PayPal IPN handler.
* BUG FIX/ENHANCEMENT: Fixed issues where HTML entities were shown in level prices in some places when using certain currencies. All prices are sent through a special pmpro_escape_price function that allows div, span, and sup tags with id and class attributes. Also removed from unneeded small tags and grey coloring of prices in certain spots.
* BUG FIX: Now cancelling membership when a SUBSCRIPTION_CANCELED message is sent to the Braintree webhook handler. In the past, we incorrectly sent the payment failed email instead.
* BUG FIX: Fixed display issues with the Require Membership block. The level select field has been swapped with a list of checkboxes.
* BUG FIX: Fixed warnings that occurred when processing failed payments in webhook and IPN handlers.
* BUG FIX: Fixed our Braintree class so we will only attempt to update a user's credit card and address when the getCustomer method is called at checkout or during a billing update.
* BUG FIX: Fixed issue where refreshing the checkout review page when using PayPal Express caused the associated order to be updated again. Now the order status is updated to review and only updates again when the user confirms.
* BUG FIX: Avoiding warnings when the pmpro_url function is used if the PMPro pages haven't been set up yet. (Thanks, Thomas Sjolshagen)
* REFACTOR: Updated the pmpro_getSpecificMembershipLevelForUser( $user_id, $level_id ) function so both fields are required. Will still default to the current user if null is passed for the $user_id.

= 2.5.6 - 2021-03-05 =
* SECURITY: Now sanitizing and escaping the `order` parameter when filtering the users table in the dashboard. (Thanks, Gen Sato)
* BUG FIX/ENHANCEMENT: Now hiding the ApplePay/GooglePay "Payment Request" buttons when the main checkout form is submitted. This helps to prevent double checkouts.
* BUG FIX: Fixed missing membership data in the billing failed email.

= 2.5.5 - 2021-02-22 =
* SECURITY: Better sanitization of parameters on some REST API endpoints.
* SECURITY: Now showing reCAPTCHA field at checkout even for logged in users.
* ENHANCEMENT: Added find_billing_address() method to the MemberOrder class. This will look for the address on the last order with the same sub id or in user meta.
* ENHANCEMENT: Better styling for invoices shown on the frontend.
* ENHANCEMENT: No longer forcing column width % in the members list table.
* ENHANCEMENT: Added a pmpro_doing_webhook action that is fired at the beginning of our webhook/IPN handlers.
* ENHANCEMENT: Added a pmpro_membership_level_after_billing_details_settings hook to the edit membership level page. This hook should now be used to add billing related settings.
* BUG FIX/ENHANCEMENT: Allowing order total to be set to 0, even if there is a subtotal and tax amount.
* BUG FIX/ENHANCEMENT: Stripe checkout fields will now use the language set in the Stripe settings.
* BUG FIX/ENHANCEMENT: The URL check in our notifications code now accepts arrays (e.g. to see if a URL has one of a group of top level domains). This fixes a warning some may have seen in error logs.
* BUG FIX: Fixed issues where totals on PayPal recurring payments were sometimes incorrect if both an mt_gross and amount field were passed via IPN.

= 2.5.4 - 2021-01-28 =
* ENHANCEMENT: Bump license year 2021 - 10 years.
* ENHANCEMENT: Now passing billing street in `pmpro_tax` filter.
* ENHANCEMENT: Prefixed our pmpro_stripeResponseHandler function to avoid conflicts.
* ENHANCEMENT: Added getRealPaymentTransactionId method to PayPal Express gateway class to recover a missing transaction ID.
* ENHANCEMENT: Added `pmpro_checkout_before_form` action to hook anything before the membership checkout form.
* ENHANCEMENT: Added avatar as a valid field type for the [pmpro_member] shortcode.
* ENHANCEMENT: Changed license key field to text type and unmasked. Masking implied the key was hashed before saving which is not true.
* ENHANCEMENT: Added`pmpro_discount_code_used` action hook for when a discount code is used.
* ENHANCEMENT: Stripe will now pull billing address info for recurring orders from webhooks.
* BUG FIX/ENHANCEMENT: Improved user interface, error handling, and messages in the frontend password reset process.
* BUG FIX/ENHANCEMENT: Added a space between state and zip code in billing info.
* BUG FIX/ENHANCEMENT: Now rounding amount sent with Stripe payment request button.
* BUG FIX/ENHANCEMENT: Improved `pmpro_check_plugin_version` function to also check a specific value of the `get_plugin_data` array.
* BUG FIX/ENHANCEMENT: Added `pmpro_membership_levelmeta` and `pmpro_membership_ordermeta` tables to uninstall process.
* BUG FIX/ENHANCEMENT: Escaped things in SQL queries in 2Checkout INS service handler.
* BUG FIX/ENHANCEMENT: Cleaned up levels page template and added MMPU compatibility.
* BUG FIX/ENHANCEMENT: Fixed pagination and export issues with a discount code filter on the Orders admin page.
* BUG FIX/ENHANCEMENT: Prefixed our `pmpro_stripeResponseHandler` function to avoid conflicts with other Stripe code that may not be prefixed.
* BUG FIX/ENHANCEMENT: Cleaned up conditionals and escaping improvements in the `pmpro_redirect_to_logged_in` function.
* BUG FIX/ENHANCEMENT: Fixed deprecation notices for sites running PHP 8.
* BUG FIX/ENHANCEMENT: Improved SQL query format in the applydiscountcode service.
* BUG FIX: Fixed issues with ReCAPTCHA v2 and certain gateways.
* BUG FIX: Fixed bug where blog name was not showing in Admin Activity email.
* BUG FIX: Improved incorrect PHP doc blocks.
* BUG FIX: Fixed an issue on some sites where password reset link in email was incorrect.
* BUG FIX: Fixed level change issues during 2Checkout checkout.
* BUG FIX: Fixed issue where `checkout_levels` REST API endpoint could return the wrong initial payment
* BUG FIX: Fixed undefined notice for timestamp variable in the Stripe gateway class.
* BUG FIX: Avoiding warnings when user ids are in the memberships_users table, but a user doesn't exist.
* BUG FIX: Now setting the correct value for membership_id in the admin change emails.

= 2.5.3 - 2021-01-26 =
* SECURITY: Fixed indirect object reference vulnerability where order information, including customer names, email addresses, and order numbers could be accessed by non-admin WordPress users. (Thanks, WP Plugins Team)
* SECURITY: Now checking ReCAPTCHA validation before enabling the submit button on the checkout form when using ReCAPTCHA v2. This helps to keep bad actors from testing credit cards on your checkout page. We were already doing a similar check when using ReCAPTCHA v3. Further updates to rate limit credit card failures are planned.

= 2.5.2 - 2020-10-23 =
* BUG FIX: Fixed issue where the RECAPTCHA library wasn't being loaded early enough to validate at checkout.
* BUG FIX: Fixed issue where code in the Stripe class was unsetting some required fields, even if Stripe was not being used at checkout.

= 2.5.1 - 2020-10-16 =
* SECURITY: Fixed XSS vulnerability on the Members List page of the dashboard. (Thanks, Ron Masas from Checkmarx.com)
* ENHANCEMENT: Add Ukrainian Hryvnia currency. (Thanks, Mirco Babini)
* ENHANCEMENT: Added a "non-members" option to the Beaver Build module.
* BUG FIX: Fixed issue where only USD and US were allowed with Stripe's GooglePay/ApplePay buttons.
* BUG FIX: Fixed issue where some profile fields, e.g. those added with Register Helper, were accidentally updated or removed when accessing the frontend profile page.
* BUG FIX: Fixed issue with tracking discount code uses when using the 2Checkout gateway. (Thanks, karambk on GitHub)
* BUG FIX: No longer running excerpts through wpautop when a more tag is used.

= 2.5 - 2020-10-02 =
* FEATURE: When using the Stripe Gateway, you may now allow users to pay using Apple Pay, Google Pay, or Microsoft Pay depending on their browser. Enable this feature from the payment settings page.
* FEATURE: Added Divi Builder compatibility.
* FEATURE: Updated the Braintree Gateway class to be able to use the Braintree API for the pmpro_next_payment() function. Note, for performance reasons, you must call this method directly or enable it by hooking it up with code like `add_filter('pmpro_next_payment', array('PMProGateway_braintree', 'pmpro_next_payment'), 10, 3);`
* FEATURE: Added ordermeta tables and functions. We will wait about a year for all users to upgrade before using these widespread. (Thanks, Mirco Babini)
* ENHANCEMENT: The "short" version of the level cost text for a free level is now "Free" instead of "0.00 now".
* ENHANCEMENT: Added a `get_original_subscription_order` method to the MemberOrder class. This will return the first order in a subscription when called from a recurring order.
* ENHANCEMENT: Removed the old style license nags.
* BUG FIX/ENHANCEMENT: Using microtime and a static counter int to make sure our order and discount codes are unique. In the past very high traffic sites could run into duplicates if two checkouts happened at the exact same second.
* BUG FIX/ENHANCEMENT: Adjust order delete prompt to support other locales.
* BUG FIX/ENHANCEMENT: Better handling of tax amounts in recurring payments, e.g. when using the PMPro VAT Tax add on.
* BUG FIX/ENHANCEMENT: Optimized how often we hit the Stripe API when events on the checkout page could potentially update the price of checkout.
* BUG FIX/ENHANCEMENT: The checkout_levels api call now takes `level` as param.
* BUG FIX/ENHANCEMENT: No longer running sanitize_text_field on password fields. This would break passwords that had strings of characters resembling html tags.
* BUG FIX/ENHANCEMENT: Now warning admins if the Stripe billing period is longer than 1 year. Billing periods greater than 1 year are not allowed by Stripe.
* BUG FIX/ENHANCEMENT: Now detecting when a Stripe webhook is set up for an older version of the Stripe API and showing a notice with a link to update.
* BUG FIX/ENHANCEMENT: Adding MAXFAILEDPAYMENTS=1 to PayPal add subscription requests. This tells PayPal to cancel a subscription after the first failed payment. In our experience, the automatic retries rarely worked well. This change fixes issues with subscriptions going out of sync or users retaining access to your site when their payment has failed. Members still receive the payment failed email, which prompts users to return to the site to renew.
* BUG FIX/ENHANCEMENT: Fixing some issues where we are adding extra break tags into the password reset email. There are still some issues like this when using certain plugins. We are working on a general fix.
* BUG FIX/ENHANCEMENT: Removed the "coupon amount" field from the edit order page. These were hold outs from the 2007! ecommerce plugin PMPro was forked from. You can set the pmpro_orders_show_coupon_amounts filter to __return_true to show these fields again if you were using them for tracking things in your custom code.
* BUG FIX: Fixed MMPU compatibility when using discount codes.
* BUG FIX: No longer filtering the wp login url when on wp-login.php. This fixes issues with iThemes Security 2FA.
* BUG FIX: Fixed issues where the Stripe webhook was not being updated sometimes when clicking the button to update.
* BUG FIX: Fixed some notices and warnings when using Braintree.
* BUG FIX: Now resetting memberslist page number when changing shown level.
* BUG FIX: Now ensuring that the discount code field updates, update the Request Button price.
* BUG FIX: Fixed issue where non-pretty permalinks may break frontend password resets.
* BUG FIX: Fixed invoice links on the account page. (Thanks, Mateusz Hołtyn)
* BUG FIX: Fixed incorrect label "for" attribute for uninstall setting.
* BUG FIX: Fixed issue where some free plugins distributed by PMPro would show warnings about requiring a Plus license.

= 2.4.4 - 2020-09-02 =
* BUG FIX: Fixed fatal error that sometimes occurred on the payment settings page when using PHP 5.6 or earlier.
* BUG FIX: Fixed fatal errors that showed up on the frontend invoice page.
* BUG FIX: Fixed issue where the confirmation message was not showing up in the confirmation email if that option was checked.
* ENHANCEMENT: Added a pmpro_stripe_charge_params filter that can be used to edit or add params sent to the Stripe create charge method. (Thanks, Michael Bester)
* ENHANCEMENT: Tweaked the markup of the invoice page so the payment type information looks a little better.

= 2.4.3 - 2020-08-25
* SECURITY: Fixed a cross-site scripting vulnerability in the code that updates the Required Membership settings on a post. This vulnerability could have been used in conjunction with other security vulnerabilities to trick an admin into editing the membership settings for a page, potentially exposing members only content to non-members. It is unlikely that there was any active exploitation of this vulnerability. This issue may also have shown up as a bug on some sites using page builders, where the membership settings for a post would be cleared out when editing a post. (Thanks to the wp.org plugin review team for catching this issue.)
* SECURITY: Better escaping of variables shown in the Require Membership meta box and related SQL queries.
* BUG FIX/ENHANCEMENT: Renamed the Vietnamese language files to match what is expected.

= 2.4.2 - 2020-08-24
* SECURITY: Updated the PMPro REST API endpoints accessed via the GET method to also require appropriate capabilities to access. The membership confirmation text will be hidden from non-members and non-admins. The endpoints to check a user's level or access to a post require the pmpro_edit_memberships capability now. You should make sure your API users have the appropriate capabilities to use the API. You can use the pmpro_rest_api_route_capabilities filter and/or pmpro_rest_api_permissions filter to change this behavior.
* BUG FIX: Fixed issues with the PMPro REST API endpoints, including the discount code and checkout level endpoints.
* BUG FIX: Fixed issue with backslashes in the display name when editing form the PMPro frontend profile page.
* BUG FIX: Fixed issue where timestamps were showing up incorrectly for recent orders shown on the dashboard page.
BUG FIX: Fixed issue where PMPro would always try to add capabilities to the administrator role, even if you removed that role for some reason.
* ENHANCEMENT: Added a pmpro_get_no_access_message() function, which can be used to show the no access messages.
* ENHANCEMENT: Added a "show_noaccess" property to the membership shortcode. When set, it will show the noaccess message to users who don't have the levels specified.
* ENHANCEMENT: Added a pmpro_user_profile_update_errors hook, which can be used to show errors on the PMPro frontend profile page.
* ENHANCEMENT: The pmpro_set_capabilities_for_role() function now returns true or false if the caps were added in case others want to use this function and tell if it worked.
* ENHANCEMENT: You can now include links in the description of the fields you add to the PMPro advanced settings page via the pmpro_custom_advanced_settings filter.
* ENHANCEMENT: Updated the PayPal gateways to use the latest versions of the PayPal buttons.
* ENHANCEMENT: Fixed styling of the PMPro update script notice.
* ENHANCEMENT: Added the pmpro_account_membership_expiration_text filter to the expiration dates shown on the cancel page when using MMPU.

= 2.4.1 - 2020-08-10 =
* BUG FIX: Fixed issues with password resets on WP Engine hosting due to security features added by their mu-plugin.
* BUG FIX: Fixed issue where end dates were showing up incorrectly in the confirmation email sometimes.
* BUG FIX: Fixed issue where renewing memberships were extended one day less than they should have been in some cases.
* BUG FIX: Fixed issue where users without a PMPro Plus license were sometimes not getting an error when trying to update a Plus Add On.
* BUG FIX/ENHANCEMENT: Added compatibility for core auto-updates for our Add Ons which aren't hosted in the .org repository.
* BUG FIX/ENHANCEMENT: Fixed issue where PHP sessions were set up to track ReCAPTCHA even if you weren't using ReCAPTCHA. ReCAPTCHA is now only loaded on the checkout page. Loading sessions unecessarily would break some Varnish cache setups.
* BUG FIX/ENHANCEMENT: Updated the single invoice/order page. No longer showing the end date, which isn't really related to the order. Showing a better status related to the order now.
* BUG FIX/ENHANCEMENT: Fixed some links to the PMPro site in the plugin admin area.
* BUG FIX/ENHANCEMENT: Now saving a hash of the Stripe secretkey when saving webhook ids. This allows us to keep track of webhook ids if you switch between gateway environments or swap your Stripe keys for some reason.
* BUG FIX/ENHANCEMENT: No longer running the Terms of Service text through wpautop. This usually just added extra spacing to your TOS. Shortcodes are rendered now though. Added a filter pmpro_tos_content so you can change the TOS content or how it is shown.
* ENHANCEMENT: Added a checkout_levels API endpoint. This will allow us to build features that adjust the price on the frontend at checkout.
* ENHANCEMENT: Added a pmpro_member_profile_edit_form_tag action to the form tag on the frontend member profile page. This is useful to set the form enctype for file uploads.
* ENHANCEMENT: Added Romanian Leu as a currency option.
* ENHANCEMENT: Added the pmpro_stripe_payment_intent_params filter. Useful if you would like to set a specific statement descriptor for the site. See https://gist.github.com/ideadude/16983fdfa0da12fc40ef36d870f4cbd0
* REFACTOR: Removed some unused methods from the Stripe class.
* REFACTOR: Removed the help pointer about the menu location change.

= 2.4 - 2020-07-24 =
* FEATURE: Now detecting if the Stripe webhook is set up correctly. You can now create or disable the webhook from the payment settings page in the WP admin dashboard.
* FEATURE: Added a link to use and set up SendWP for more reliable email sending from WP.
* BUG FIX: Fixed further issues with dates and timezones.
* BUG FIX: Fixed issue where reports would cause white screens on some server set ups. We had some report start dates set to 1960, which caused issues. (Thanks, Sam "gausam" on GitHub)
* BUG FIX: Fixed issue with the query to find expiring memberships that happened on certain MySQL setups.
* BUG FIX: Fixed issue that was caused if other code called wp_login_url() too early.
* BUG FIX: Fixed an error in the is_login_page() function.
* BUG FIX: Fixed a fatal error that was happening in PHP 5.2 or earlier due to code syntax that was not supported then. We noticed a few other cases as well, but decided we won't support PHP 5.2 consistent with WP and other plugins.
* BUG FIX: Fixed the URL used when using 2Checkout in sandbox mode.
* BUG FIX: Fixed JavaScript errors that would occur sometimes on the Billing Update page when using the Stripe gateway.
* BUG FIX: Fixed issue where the dummy $0 orders created when using the "Stripe Updates" feature weren't saving with the updated subscription_transaction_id. This would prevent future payments from being linked to that user and could prevent subscriptions cancellations from being synchronized. When updating to PMPro 2.4, an update script will run to try to restore these subscription_transaction_id values. However, any recurring orders that occured when the id was missing will not be added to PMPro. You will have to update them manually.
* BUG FIX: Fixed JavaScript error on the edit discount code page.
* BUG FIX/ENHANCEMENT: Showing expiration date as text when it is set as a readonly field. (Thanks, Rodmar "rodmarzavala" on GitHub)
* BUG FIX/ENHANCEMENT: Now checking if headers were already sent before trying to start the PHP session. If headers are sent before PMPro tries to start the session, there is usually another error somewhere on the WP site that needs to be fixed. But at least we aren't adding to the confusion by trying to start the session late causing another error in the log.
* BUG FIX/ENHANCEMENT: Updated misleading hint for the PayPal Express IPN URL on the payment settings page.
* BUG FIX/ENHANCEMENT: Fixed invalid key description in the SQL in includes/setup.sql. The actually query used to set up table in PMPro was correct though. The setup.sql file is included for reference and developers who want to create the tables "manually" in MySQL.
* BUG FIX/ENHANCEMENT: The post type search filter now supports cases where post type set in WPQuery is an array.
* BUG FIX/ENHANCEMENT: Fixed warning that showed when a user with no levels visited the frontend account page.
* BUG FIX/ENHANCEMENT: Fixing warnings that would be logged at checkout in certain cases.
* BUG FIX/ENHANCEMENT: Better handling of cases where users who checked out using a gateway different from the current setting are shown a message that they cannot update their billing information. They should instead checkout again to renew their membership.
* ENHANCEMENT: Updated to use the latest version of the Stripe API and SDK.
* ENHANCEMENT: More detailed logging for Braintree webhook debug emails.
* ENHANCEMENT: Added a getTransactionStatus method to the PayPal and PayPal Express payment gateway classes. (Thanks, Mirco Babini)
* ENHANCEMENT: Added a checkout_level API call. This will be used in the future to update the price total at checking using JS and is also needed to implement support for Google Pay and Apple Pay through Stripe.
* ENHANCEMENT: Cleaned up the email settings page.
* ENHANCEMENT: Better handling of some login and password reset errors.
* ENHANCEMENT: Added links to the PMPro YouTube and Facebook profiles.
* REFACTOR: Cleaned up some code in incldues/content.php, especially around the pmpro_search_filter() function.
* REFACTOR: Removed the package-lock.json file from the repository.

= 2.3.4 - 2020-06-18 =
* SECURITY: Better escaping of values on the billing and confirmation pages.
* BUG FIX: Fixed issue where expiration dates could be set to 1 day in the past when editing a user in the dashboard if certain timezones were chosen in the General settings.
* BUG FIX: Fixed issue where users were redirected back to the /login/ page if WordPress needed them to confirm their admin email address. Users will now be taken to the default WP login page with the form to confirm their email address.
* BUG FIX: Fixed bug where the reset password link in the new user email was not filtered to go to the frontend login page if being used.
* BUG FIX: Fixed issue where some errors were not being shown when password resets failed.
* BUG FIX: Fixed bug with action links added to the orders table.
* BUG FIX: Fixed issue where empty dates would show current date in the members list.
* BUG FIX: Fixed fatal error that was happening when using some of the new API endpoints.
* BUG FIX: Timestamps returned by the Stripe API when getting the next payment date needed to be adjusted based on the site's timezone setting.
* BUG FIX: Fixed a bug where the change password form wouldn't show up sometimes when using the login shortcode.
* BUG FIX: Fixed notice in the PayPal IPN handler when adding notes to an order.
* BUG FIX: Fixed issue where PMPro would generate the wrong excerpt in some cases where the more tag was used but the excerpt was generated before the more tag code or blog was not yet converted to HTML. Specifically this fixes an issue with excerpts generated for AMP with the SchemaApp plugin.
* BUG FIX/ENHANCEMENT: Added an advanced setting to "Uninstall PMPro on Deletion". You must check and save this option first or PMPro will not delete data from the DB when deleting from the plugins page. This keeps users from accidentally deleting orders and member data.
* BUG FIX/ENHANCEMENT: Now hiding the profile and change password links on the membership account page if a frontend profile page is not set and users are locked from the WP dashboard by the advanced setting.
* BUG FIX/ENHANCEMENT: Resetting the signups and cancellations report cache when there are new membership level changes.
* ENHANCEMENT: Added a pmpro_get_element_class function and filter. We now use this function when adding classes to HTML elements in our templates. The filter can be used to alter or append to the classes used in the HTML tags. This will make it easier to create code and CSS to make PMPro look better with popular themes.
* ENHANCEMENT: Added a pmpro_authorizenet_post_values filter to the Authorize.net class. An array of $post_values is passed in to be filtered along with a string for the API method about to be called.
* ENHANCEMENT: Added a pmpro_member_profile_edit_user_object_fields filter to add or remove fields from the frontend edit profile page.
* ENHANCEMENT: Now showing information about the current billing method on the update billing page. Can hide this information by having the pmpro_billing_show_payment_method filter return false.
* ENHANCEMENT: No longer saying "Great Work!" in the admin digest emails. This was especially embarrassing if you didn't have any sales during the diget period.
* REFACTOR: Refactored some code in the CSV exports to avoid false positives by malware scanners.
* REFACTOR: Added a build_post_string method to the Authorize.net class to avoid redundant code.
* REFACTOR: Added a cancelSubscriptionAtGateway method to the PayPal Express class. This is useful if you want to cancel the subscription without cancelling the membership. (Thanks, Mirco Babini)

= 2.3.3 - 2020-05-13 =
* SECURITY: Fixed SQL injection vulnerability when logged in as an administrator and adding new orders in the dashboard. JVN#20248858 (Thanks, Kenichi Okuno of Mitsui Bussan Secure Directions, Inc)
* SECURITY: Making sure to properly escape all values on the add/edit order form in the dashboard.
* BUG FIX: Now properly setting the order status to "error" when an initial payment fails when using PayPal Express. Before the order status would be set as "cancelled", which would count the order toward reports and make it harder to find orders that had errors. (Thanks, Mirco Babini)
* BUG FIX: Fixed issue with the PMPro logo and some other assets loading over the wrong schema (http vs https) in some cases.
* BUG FIX: Fixed issue where the chosen discount code was not shown after submitting when adding a new order through the dashboard.
* BUG FIX/ENHANCEMENT: Using "PMPro" in the admin activity email subject to keep the line shorter and avoid issues when replacing the word "member" via gettext.
* ENHANCEMENT: Added a pmpro_allow_weak_passwords filter. You can set this to return true (like this https://gist.github.com/ideadude/5a12119b9ce1c2aad87b2d69cb8f9505) to allow weak passwords on the change password and reset password pages. Note that at this time, weak passwords are still allowed on the checkout page no matter the value of this filter. We expect to change that in the future. For now, you can use our PMPro Strong Passwords plugin to force strong passwords at checkout.
* REFACTOR: Updated the logic around checking the PMPRO_IPN_DEBUG constant in the IPN handler. (Thanks, Mirco Babini)

= 2.3.2 - 2020-05-07 =
* BUG FIX: Fixed errors calling is_main_query() that came up with certain themes.
* BUG FIX: Fixed typo in the pmpro_account_profile_action_links filter.
* BUG FIX/ENHANCEMENT: Added a new force parameter to the pmpro_getAllLevels() function. This is used by the Multisite Membership Add On to fix an issue where levels were missing or incorrect on the subsites.
* ENHANCEMENT: Removed mention of the ezAdsense plugin, which has been discontinued.
* ENHANCEMENT: Added $recipient param in sendAdminActivity() function so you can send additional activity emails like this https://gist.github.com/dparker1005/6bf650370a12aef44adf8c8c26d3e906

= 2.3.1 - 2020-05-01 =
* BUG FIX: Fixed infinite redirect issue if no account page was set. Fixed a few other places where we do is_page() type checks just in case.
* BUG FIX: Fixed issue where all pages were retitled to Welcome when logged in, if no login page was set.
* BUG FIX: Fixed issue with BuddyBoss and other themes/plugins that use the_title filter with only one parameter.
* BUG FIX: Fixed error when trying to check if is_main_query in the admin or with certain themes.

= 2.3 - 2020-05-01 =
* FEATURE: Added frontend login and password reset.
* FEATURE: Added frontend user profile editing.
* FEATURE: Added [pmpro_login] shortcode and Log In Form block.
* FEATURE: Added [pmpro_member_profile_edit] shortcode and Member Profile Edit block.
* FEATURE: Added "Member Log In" widget.
* FEATURE: Added "WordPress Toolbar" Advanced Setting to hide the WordPress Toolbar from "subscriber" role.
* FEATURE: Added "WordPress Dashboard" Advanced Setting to block dashboard access for the "subscriber" role.
* FEATURE: Added new Admin Activity Email. Weekly emails to the site admin with sales stats and other info. Change how often the email is sent or disable it from the advanced settings tab.
* FEATURE: Added Beaver Builder module compatibility to restrict modules by membership level.
* FEATURE: Created new REST API endpoints and extended existing endpoints.
* FEATURE: Updated Elementor code to allow for restriction of "sections" as well.
* BUG FIX: Updated all timestamp code to be compatible with WordPress v5.4+ which fixes issues where orders could lose one hour or one day when saved.
* BUG FIX: Updated logic to filter body_class on pages with Membership Account shortcode or any "section" of the shortcode displayed.
* BUG FIX: Improved `pmpro_getAllLevels` function to cache even when `force` is `true`. This saves multiple DB hits per page load.
* BUG FIX/ENHANCEMENT: Cancellation report now calculates based on membership enddate.
* BUG FIX/ENHANCEMENT: Fixed warnings and errors in PHP 7.4+.
* BUG FIX/ENHANCEMENT: Now allowing translation for text generated by JavaScript.
* BUG FIX/ENHANCEMENT: Updated all uses of "Email" to remove the hyphen.
* BUG FIX/ENHANCEMENT: Updated to default to international addresses on Billing Information page. Fixes a bug with the State Dropdown Add-On.
* BUG FIX/ENHANCEMENT: Now treating "recurring_payment_failed" transactions from PayPal IPN as cancellations. PMPro will cancel membership and attempt to cancel the associated subscription.
* ENHANCEMENT: Added membership level class for the `PMPro_Membership_Level` object. This is currently only used in the REST API calls, but will eventually be used whenever interacting with a membership level object or array.
* ENHANCEMENT: Added discount code class for the `PMPro_Discount_Code` object. This is currently only used in the REST API calls, but will eventually be used whnever interacting with a discount code object or array.
* ENHANCEMENT: Now allowing all users and members access to the Membership Account page.
* ENHANCEMENT: Updating logic for all redirects from core pages like Invoices, Billing, and Cancel to allow past members to access their data. Generally more often redirecting where you would expect to in different situations.
* ENHANCEMENT: Several core frontend page style improvements for responsive displays and gateway-dependent fields.
* ENHANCEMENT: Added `getSubscriptionStatus` method to the Stripe gateway API class. This fixes issues with the PMPro Subscription Check Add-On.
* ENHANCEMENT: Added !!levels_page_url!! and !!login_url!! as replacement variables in Advanced Settings > Message Settings. Using these by default on new installs.
* ENHANCEMENT: Improved Block Editor code and webpack configuration.
* ENHANCEMENT: Added support for `PMPRO_AUTHNET_SILENT_POST_DEBUG` to "log" data to /logs/ or send an email to an email address different from the site admin.
* ENHANCEMENT: Added time fields to Memberships > Orders admin page when vieweing, updating or saving an order.
* ENHANCEMENT: Added pmpro_admin_orders_filters and pmpro_admin_orders_query_condition filters to add new filters to the orders page in the dashboard. (Thanks, Mirco Babini)
* ENHANCEMENT: Added an SVG icon to the PMPro blocks category.
* REFACTOR: Improved the Members List list table code to use a function for each column of data and support the code core WP methods for extending list tables with custom columns.
* REFACTOR: Moved all Theme My Login compatiblity code to includes/compatibility/theme-my-login.php and only loading if plugin is active.

= 2.2.6 - 2020-02-20 =
* SECURITY: Escaping the post title shown in the Terms of Service section of the checkout page.
* BUG FIX: Fixed issue where the CVV/Security Code was not being passed to Authorize.net when using that gateway.
* BUG FIX: Fixed issues with the update billing page when using Stripe.
* BUG FIX: Fixed issues with the update billing page when using the MMPU Add On.
* BUG FIX: Fixed issue where password fields would disappear when the checkout form was submitted. This behavior was required to address bugs in older versions of iOS that shouldn't be in use any more.
* BUG FIX: No longer sending an extra cancel request to the PayPal API when processing a cancel for a PayPal Express subscription through the IPN handler.
* BUG FIX: The currency option is no longer hidden when using the check gateway.
* BUG FIX: Fixed the comparisons in the pmpro_check_plugin_version function and related notification checks.
* BUG FIX: Avoiding warnings in the sendAdminChangeEmail method if the user doesn't have a level.
* BUG FIX: Fixed some cases where the Members List CSV export wouldn't match the members shown in the table/search.
* BUG FIX: Fixed issue where the Members List may show the wrong count or enddate.
* BUG FIX/ENHANCEMENT: Added support for Elementor. Filtering content later so the builder's filters can run first. Also added the ability to choose which membership levels an element should be visible for.
* BUG FIX/ENHANCEMENT: Fixed the confirmation page formatting when paying by check. Added a div with class "pmpro_payment_instructions" around the payment instructions shown on the confirmation and invoice pages.
* BUG FIX/ENHANCEMENT: Added an Oxford Comma to the the pmpro_implodeToEnglish() function.
* BUG FIX/ENHANCEMENT: Moved the Japanese Yen symbol to the left of the total instead of the right.
* BUG FIX/ENHANCEMENT: Added the pmpro_checkout_login_redirect filter, which filters the url_redirect parameter of the login link on the checkout page. This is used by some Add Ons to make sure you are returned to the checkout page properly after logging in through that link.
* ENHANCEMENT: Added the Ghanian Cedi currency.
* ENHANCEMENT: Added the pmpro_are_levels_recurring() function to help with MMPU.
* ENHANCEMENT: Improved the look and source of the CVV popup.

= 2.2.5 - 2020-01-05 =
* BUG FIX: Once again loading JavaScript on the update billing page when using Braintree.
* BUG FIX: Loading Braintree JavaScript at checkout for free levels to support the variable pricing and donation add ons.
* BUG FIX: Fixed issues with PayPal orders when using the pmpro_paypal_level_description filter.
* BUG FIX/ENHANCEMENT: Responsive update for smaller device viewports for the Membership Levels table in the dashboard.
* ENHANCEMENT: Added filters: pmpro_is_level_free, pmpro_is_level_trial, and pmpro_is_level_expiring.
* ENHANCEMENT: Updated IPN handler and Stripe Webhook handler to use pmpro_cancelMembershipLevel instead of pmpro_changeMembershipLevele. This improves support for the MMPU addon.
